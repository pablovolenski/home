<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimalist Editor</title>
    <style>
        :root {
            --bg-color: #fcfcfc;
            --text-color: #333;
            --accent-color: #e0e0e0;
            --btn-hover: #d5d5d5;
            --font-main: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
        }

        /* Sidebar for Saved Files */
        .sidebar {
            width: 250px;
            background-color: #f4f4f4;
            border-right: 1px solid var(--accent-color);
            display: flex;
            flex-direction: column;
            padding: 20px 0;
        }

        .sidebar h3 {
            margin: 0 20px 15px 20px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #777;
        }

        .file-list {
            list-style: none;
            padding: 0;
            margin: 0;
            overflow-y: auto;
            flex-grow: 1;
        }

        .file-list li {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 14px;
        }

        .file-list li:hover, .file-list li.active {
            background-color: var(--accent-color);
        }

        .new-file-btn {
            margin: 20px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-family: var(--font-main);
        }

        .new-file-btn:hover { background-color: var(--btn-hover); }

        /* Main Editor Area */
        .main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .toolbar {
            display: flex;
            justify-content: flex-end;
            padding: 15px 30px;
            gap: 10px;
        }

        button {
            padding: 8px 16px;
            border: 1px solid #ccc;
            background-color: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-family: var(--font-main);
            font-size: 13px;
        }
        
        button:hover { background-color: var(--btn-hover); }

        /* Dropdown for Share */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: #fff;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
            z-index: 1;
            border: 1px solid #eee;
            border-radius: 4px;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            font-size: 13px;
        }

        .dropdown-content a:hover { background-color: #f1f1f1; }
        .dropdown.show .dropdown-content { display: block; }

        .editor-textarea {
            flex-grow: 1;
            width: 100%;
            box-sizing: border-box;
            padding: 20px 40px;
            border: none;
            resize: none;
            font-size: 16px;
            font-family: var(--font-main);
            line-height: 1.6;
            background-color: transparent;
            outline: none;
        }

        /* Discreet Word/Char Count */
        .stats {
            text-align: right;
            padding: 5px 40px 15px 40px;
            font-size: 11px;
            color: #aaa;
        }

        /* Sticky Note */
        .sticky-note {
            position: fixed;
            bottom: 20px;
            right: 30px;
            width: 200px;
            height: 200px;
            background-color: #fffacd; /* Light yellow */
            border: 1px solid #e6dca3;
            box-shadow: 2px 4px 10px rgba(0,0,0,0.05);
            border-radius: 0 0 15px 0;
            padding: 15px;
            box-sizing: border-box;
        }

        .sticky-note::before {
            content: '';
            position: absolute;
            top: 0; right: 0;
            border-width: 0 15px 15px 0;
            border-style: solid;
            border-color: #fcfcfc #fcfcfc #e6dca3 #e6dca3;
            background: #e6dca3;
            display: block; width: 0;
            box-shadow: -1px 1px 2px rgba(0,0,0,0.1);
        }

        .sticky-textarea {
            width: 100%;
            height: 100%;
            border: none;
            resize: none;
            background: transparent;
            outline: none;
            font-family: var(--font-main);
            font-size: 13px;
            line-height: 1.4;
            color: #444;
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <h3>Your Files</h3>
        <ul class="file-list" id="fileList"></ul>
        <button class="new-file-btn" id="newFileBtn">+ New File</button>
    </div>

    <div class="main-content">
        <div class="toolbar">
            <button id="saveBtn">Save</button>
            <div class="dropdown" id="shareDropdown">
                <button id="shareBtn">Share â–¾</button>
                <div class="dropdown-content">
                    <a href="#" id="downloadBtn">Download as .txt</a>
                    <a href="#" id="copyBtn">Copy to Clipboard</a>
                </div>
            </div>
        </div>
        
        <textarea class="editor-textarea" id="mainEditor" placeholder="Start typing... The first line will automatically become the file name."></textarea>
        
        <div class="stats" id="textStats">0 words | 0 characters</div>
    </div>

    <div class="sticky-note">
        <textarea class="sticky-textarea" id="stickyEditor" placeholder="Quick note..."></textarea>
    </div>

    <script>
        // DOM Elements
        const mainEditor = document.getElementById('mainEditor');
        const textStats = document.getElementById('textStats');
        const fileList = document.getElementById('fileList');
        const saveBtn = document.getElementById('saveBtn');
        const newFileBtn = document.getElementById('newFileBtn');
        const stickyEditor = document.getElementById('stickyEditor');
        const shareBtn = document.getElementById('shareBtn');
        const shareDropdown = document.getElementById('shareDropdown');
        const downloadBtn = document.getElementById('downloadBtn');
        const copyBtn = document.getElementById('copyBtn');

        let currentFileId = null;

        // --- Core Functions ---

        function loadFiles() {
            const files = JSON.parse(localStorage.getItem('myFiles')) || [];
            fileList.innerHTML = '';
            
            files.forEach(file => {
                const li = document.createElement('li');
                // Extract first line as title, fallback to 'Untitled'
                const firstLine = file.content.split('\n')[0].trim();
                li.textContent = firstLine ? firstLine : 'Untitled';
                
                if (file.id === currentFileId) li.classList.add('active');
                
                li.onclick = () => openFile(file.id);
                fileList.appendChild(li);
            });
        }

        function saveFile() {
            const content = mainEditor.value;
            if (!content.trim()) return; // Don't save completely empty files

            let files = JSON.parse(localStorage.getItem('myFiles')) || [];
            
            if (currentFileId) {
                // Update existing
                const index = files.findIndex(f => f.id === currentFileId);
                if (index > -1) files[index].content = content;
            } else {
                // Create new
                currentFileId = Date.now().toString();
                files.push({ id: currentFileId, content: content });
            }

            localStorage.setItem('myFiles', JSON.stringify(files));
            loadFiles();
        }

        function openFile(id) {
            const files = JSON.parse(localStorage.getItem('myFiles')) || [];
            const file = files.find(f => f.id === id);
            if (file) {
                currentFileId = file.id;
                mainEditor.value = file.content;
                updateStats();
                loadFiles(); // Update active class
            }
        }

        function startNewFile() {
            currentFileId = null;
            mainEditor.value = '';
            updateStats();
            loadFiles();
        }

        // --- UI Interactions & Listeners ---

        // Word and Character Count
        function updateStats() {
            const text = mainEditor.value;
            const chars = text.length;
            const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            textStats.textContent = `${words} words | ${chars} characters`;
        }

        mainEditor.addEventListener('input', updateStats);

        // Auto-save on typing (optional, but good UX for local storage)
        mainEditor.addEventListener('input', () => {
            if(currentFileId) saveFile(); // Auto-save if it's an existing file
        });

        // Sticky Note Logic (Independent of main files)
        stickyEditor.value = localStorage.getItem('stickyNote') || '';
        stickyEditor.addEventListener('input', () => {
            localStorage.setItem('stickyNote', stickyEditor.value);
        });

        // Button Listeners
        saveBtn.addEventListener('click', saveFile);
        newFileBtn.addEventListener('click', startNewFile);

        // Share Dropdown Toggle
        shareBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            shareDropdown.classList.toggle('show');
        });

        window.addEventListener('click', () => {
            if (shareDropdown.classList.contains('show')) {
                shareDropdown.classList.remove('show');
            }
        });

        // Share: Copy to Clipboard
        copyBtn.addEventListener('click', (e) => {
            e.preventDefault();
            navigator.clipboard.writeText(mainEditor.value).then(() => {
                alert('Copied to clipboard!');
            });
        });

        // Share: Download as .txt
        downloadBtn.addEventListener('click', (e) => {
            e.preventDefault();
            const text = mainEditor.value;
            if(!text) return;
            
            const firstLine = text.split('\n')[0].trim() || 'document';
            // Clean the title so it's a valid filename
            const filename = firstLine.replace(/[^a-z0-9]/gi, '_').toLowerCase() + '.txt';
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        });

        // Initialize
        loadFiles();
        updateStats();

    </script>
</body>
</html>
